import{fa_comment,fa_paper_plane,fa_street_view,fa_shirt,fa_camera_retro,fa_info_circle,fa_xmark}from"./icons.js";import{showMessage,i18n}from"./message.js";class ToolsManager{constructor(t,e,a){this.config=e,this.tools={hitokoto:{icon:fa_comment,callback:async()=>{var e=await(await fetch("https://v1.hitokoto.cn")).json(),o=a.message.hitokoto;let t=i18n(o,e.from,e.creator);showMessage(e.hitokoto,6e3,9),setTimeout(()=>{showMessage(t,4e3,9)},6e3)}},asteroids:{icon:fa_paper_plane,callback:()=>{var e;window.Asteroids?(window.ASTEROIDSPLAYERS||(window.ASTEROIDSPLAYERS=[]),window.ASTEROIDSPLAYERS.push(new window.Asteroids)):((e=document.createElement("script")).src="https://fastly.jsdelivr.net/gh/stevenjoezhang/asteroids/asteroids.js",document.head.appendChild(e))}},"switch-model":{icon:fa_street_view,callback:()=>t.loadNextModel()},"switch-texture":{icon:fa_shirt,callback:()=>{let e="",o="";a&&(e=a.message.changeSuccess,o=a.message.changeFail),t.loadRandTexture(e,o)}},photo:{icon:fa_camera_retro,callback:()=>{var e,o=a.message.photo,o=(showMessage(o,6e3,9),document.getElementById("live2d"));o&&(o=o.toDataURL(),(e=document.createElement("a")).style.display="none",e.href=o,e.download="live2d-photo.png",document.body.appendChild(e),e.click(),document.body.removeChild(e))}},info:{icon:fa_info_circle,callback:()=>{open("https://github.com/stevenjoezhang/live2d-widget")}},quit:{icon:fa_xmark,callback:()=>{localStorage.setItem("waifu-display",Date.now().toString());var e=a.message.goodbye;showMessage(e,2e3,11);let o=document.getElementById("waifu");o&&(o.classList.remove("waifu-active"),setTimeout(()=>{o.classList.add("waifu-hidden");var e=document.getElementById("waifu-toggle");null!=e&&e.classList.add("waifu-toggle-active")},3e3))}}}}registerTools(){var e,o,t,a;Array.isArray(this.config.tools)||(this.config.tools=Object.keys(this.tools));for(e of this.config.tools)this.tools[e]&&({icon:o,callback:t}=this.tools[e],(a=document.createElement("span")).id="waifu-tool-"+e,a.innerHTML=o,null!=(o=document.getElementById("waifu-tool"))&&o.insertAdjacentElement("beforeend",a),a.addEventListener("click",t))}}export{ToolsManager};